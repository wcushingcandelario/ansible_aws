---

- name: Create Utility RDS
  hosts: all
  tasks:
    - name: Update configs from AMI
      with_items:
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.preprod' src: '{{ ovc_install_dir }}/Platform-Dynamic-Objects/config/unifiedConfig.properties' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.preprod' src: '{{ ovc_install_dir }}/Platform-Dynamic-Objects/config/tools.properties' }
        - { dest: 'roles/oneview/files/env_files/context.xml.preprod' src: '/opt/jetty/webapps/context.xml' }
        - { dest: 'roles/oneview/files/env_files/database.php.preprod' src: '/var/www/html/ovcdashboard/app/Config/database.php' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.preprod' src: '/var/www/html/ovcdashboard/app/Config/setting_var.php' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.prod' src: '{{ ovc_install_dir }}/Platform-Dynamic-Objects/config/unifiedConfig.properties' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.prod' src: '{{ ovc_install_dir }}/Platform-Dynamic-Objects/config/tools.properties' }
        - { dest: 'roles/oneview/files/env_files/context.xml.prod' src: '/opt/jetty/webapps/context.xml' }
        - { dest: 'roles/oneview/files/env_files/database.php.prod' src: '/var/www/html/ovcdashboard/app/Config/database.php' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.prod' src: '/var/www/html/ovcdashboard/app/Config/setting_var.php' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.uat1' src: '{{ ovc_install_dir }}/Platform-Dynamic-Objects/config/unifiedConfig.properties' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.uat1' src: '{{ ovc_install_dir }}/Platform-Dynamic-Objects/config/tools.properties' }
        - { dest: 'roles/oneview/files/env_files/context.xml.uat1' src: '/opt/jetty/webapps/context.xml' }
        - { dest: 'roles/oneview/files/env_files/database.php.uat1' src: '/var/www/html/ovcdashboard/app/Config/database.php' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.uat1' src: '/var/www/html/ovcdashboard/app/Config/setting_var.php' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.uat2' src: '{{ ovc_install_dir }}/Platform-Dynamic-Objects/config/unifiedConfig.properties' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.uat2' src: '{{ ovc_install_dir }}/Platform-Dynamic-Objects/config/tools.properties' }
        - { dest: 'roles/oneview/files/env_files/context.xml.uat2' src: '/opt/jetty/webapps/context.xml' }
        - { dest: 'roles/oneview/files/env_files/database.php.uat2' src: '/var/www/html/ovcdashboard/app/Config/database.php' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.uat2' src: '/var/www/html/ovcdashboard/app/Config/setting_var.php' }
        - { dest: 'roles/oneview/files/cometd/original.xml' src: '/opt/ovc/posWebapp/WEB-INF/web.xml' }
      fetch:
        src: {{ item.src }}
        dest: {{ item.dest }}
    - name: Replace database hosts preprod
      delegate_to: localhost
      with_items:
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.preprod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'preprod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.preprod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'preprod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/context.xml.preprod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'preprod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/database.php.preprod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'preprod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.preprod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'preprod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.prod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'prod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.prod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'prod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/context.xml.prod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'prod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/database.php.prod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'prod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.prod' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'prod-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.uat1' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat1-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.uat1' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat1-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/context.xml.uat1' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat1-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/database.php.uat1' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat1-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.uat1' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat1-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.uat2' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat2-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.uat2' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat2-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/context.xml.uat2' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat2-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/database.php.uat2' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat2-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.uat2' regexp: 'rds-utility\.ckzc29y1mvlx\.eu-west-1\.rds\.amazonaws\.com' replace: 'uat2-mysql.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.preprod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-preprod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.preprod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-preprod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/context.xml.preprod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-preprod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/database.php.preprod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-preprod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.preprod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-preprod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.prod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-prod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.prod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-prod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/context.xml.prod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-prod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/database.php.prod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-prod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.prod' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-prod01.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.uat1' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat1.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.uat1' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat1.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/context.xml.uat1' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat1.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/database.php.uat1' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat1.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.uat1' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat1.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/unifiedConfig.properties.uat2' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat2.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/tools.properties.uat2' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat2.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/context.xml.uat2' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat2.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/database.php.uat2' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat2.ovchosting.co.uk' }
        - { dest: 'roles/oneview/files/env_files/setting_var.php.uat2' regexp: 'mongodb-utility01\.ovchosting\.co\.uk' replace: 'mongodb-uat2.ovchosting.co.uk' }
      replace:
        dest: "{{ item.dest }}"
        regexp: "{{ item.regexp }}"
        replace: "{{ item.replace }}"
